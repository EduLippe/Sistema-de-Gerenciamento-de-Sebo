<?php
    // Arquivo onde serão salvos os livros
    $arquivo = 'livros.json';

    // Lê os livros já cadastrados
    $livros = file_exists($arquivo) ? json_decode(file_get_contents($arquivo), true) : [];

    // Se enviou o formulário
    if ($_SERVER['REQUEST_METHOD'] === 'POST') {
        $novo = [
            'titulo' => $_POST['titulo'],
            'autor' => $_POST['autor'],
            'preco' => $_POST['preco'],
            'imagem' => $_POST['imagem'] // para simplicidade, colocamos uma URL aqui
        ];
        $livros[] = $novo;
        file_put_contents($arquivo, json_encode($livros, JSON_PRETTY_PRINT));
    }
?>

<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Gerenciamento de Sebo</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-4">
    <h1>Cadastro de Livro</h1>
    <form method="post" class="row g-3 mb-4">
        <div class="col-md-4">
            <input type="text" name="titulo" class="form-control" placeholder="Título" required>
        </div>
        <div class="col-md-4">
            <input type="text" name="autor" class="form-control" placeholder="Autor" required>
        </div>
        <div class="col-md-2">
            <input type="number" step="0.01" name="preco" class="form-control" placeholder="Preço (R$)" required>
        </div>
        <div class="col-md-6">
            <input type="text" name="imagem" class="form-control" placeholder="URL da Imagem">
        </div>
        <div class="col-md-12">
            <button type="submit" class="btn btn-primary">Cadastrar</button>
        </div>
    </form>

    <div class="row">
        <?php foreach ($livros as $livro): ?>
        <div class="col-md-4 mb-4">
            <div class="card text-center text-white bg-primary">
                <img src="<?= htmlspecialchars($livro['imagem']) ?>" class="card-img-top p-3" alt="<?= htmlspecialchars($livro['titulo']) ?>" style="height: 300px; object-fit: contain;">
                <div class="card-body">
                    <h5 class="card-title"><?= htmlspecialchars($livro['titulo']) ?></h5>
                    <p class="card-text"><?= htmlspecialchars($livro['autor']) ?></p>
                    <p class="card-text fw-bold">R$ <?= number_format($livro['preco'], 2, ',', '.') ?></p>
                    <a href="#" class="btn btn-light">Descrição Item</a>
                </div>
            </div>
        </div>
        <?php endforeach; ?>
    </div>
</div>

</body>
</html>
